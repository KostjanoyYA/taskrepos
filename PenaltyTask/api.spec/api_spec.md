* [Постановка задачи](#Постановка-задачия)
* [Общие положения](#Общие-положения)
* [Типы данных](#Типы-данных)
  * [CarOwner](#CarOwner)
  * [Car](#Car)
  * [StateNumber](#StateNumber)
  * [Fine](#Fine)
  * [PenaltyEvent](#PenaltyEvent)
  * [Error](#Error)
* [Методы](#методы)
  * [GET /PenaltyEvents](#get-PenaltyEvents)
  * [GET /PenaltyEvents/{id}](#get-PenaltyEvents)
  * [POST /PenaltyEvents](#post-PenaltyEvents)
  * [PUT /PenaltyEvents/{id}](#put-PenaltyEvents)
  * [DELETE /PenaltyEvents/{id}](#delete-PenaltyEvents)  
  * [GET /Statistics/{top}](#get-Finesid)
* [Список ошибок](#список-ошибок)

## Постановка задачи
Сервлет должен выполнять:
1. параметризованный поиск штрафов в базе данных по владельцу и госномеру с выводом следующей информации:
- госномер;
- марка машины;
- модель машины;
- владелец;
- тип начисленного штрафа;
2. подготовку отчета о 5 самых частых штрафах по данным о владельце и автомобиле.

Одному владельцу может принадлежать несколько автомобилей. 
Справочник типов штрафов и пошлины по его оплате размещается в отдельной таблице-справочнике, не требующей заполнения.

## Общие положения
Передача параметров в методы `POST`, `PATCH` и `PUT` осуществляется с использованием типа данных `application/json` в кодировке UTF-8.

Результаты выполнения запросов передаются с использованием типа данных `application/json` в кодировке UTF-8.

Ошибки возвращаются с использованием типа данных [Error](#error) и семантически соответствующим http-кодом.

## Типы данных
### CarOwner
Сущность, содержащая информацию о владельце.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор владельца |
| firstName | String | да | Имя владельца |
| middleName | String | да | Отчество владельца |
| lastName | String | да | Фамилия владельца |

### Car
Сущность, содержащая информацию о машине.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор машины |
| make | String | да | Марка машины |
| model | String | да | Модель машины |
| carID | int | да | Идентификатор госномера машины |
| CarOwnerId | int | да | Идентификатор владельца машины |

### StateNumber
Сущность, содержащая информацию о госномере.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | String | да | Уникальный идентификатор госномера |
| country | String | да | Страна регистрации машины (латиница) |
| regionCode | int | да | Код региона регистрации машины |
| series | String | да | Серия госномера (3 буквы кириллицей) |
| number | int | да | Номер регистрации в серии |

### Fine
Сущность, содержащая информацию о типе штрафа и сумме начисления за него.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор штрафа |
| type | String | да | Тип штрафа |
| charge | BigDecimal | да | Сумма начислений |

### PenaltyEvent
Сущность, содержащая информацию о событии начисления штрафа.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор события |
| timeStamp | LocalDateTime | да | Время начисления штрафа |
| fineID | int | да | Идентификатор штрафа из базы |
| carID | int | да | Идентификатор машины, которой присвоен штраф |

### Report
Сущность, содержащая данные для представления данных PenaltyEvents на стороне клиента.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| EventID | int | да | Уникальный идентификатор события |
| timeStamp | LocalDateTime | да | Время начисления штрафа |
| fineType | String | да | Тип начисленного штрафа |
| fineCharge | BigDecimal | да | Сумма начисленного штрафа |
| make | String | да | Марка машины, получившей штраф |
| model | String | да | Модель машины, получившей штраф |
| fullStateNumber | String | да | Гостномер машины, получившей штраф |
| firstName | String | да | Имя владельца |
| middleName | String | да | Отчество владельца |
| lastName | String | да | Фамилия владельца |

### Statistics
Сущность, содержащая запись статистики по типам штрафов.

На стороне клиента List, содержащий записи Statistics должен отображаться в виде таблицы со следующими полями:

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор события |
| fineID | int | да | Идентификатор штрафа из базы |
| fineType | String | да | Тип начисленного штрафа |
| fineCharge | BigDecimal | да | Сумма начисленного штрафа |
| topPlace | int | да | Место top штрафа в выборке top N |
| occurrencesNumber | int | да | Количество упоминаний о данном типе штрафа в базе |

### PenaltyLog
Сущность, содержащая информацию о событии начисления штрафов.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| id | int | да | Уникальный идентификатор события |
| date | Localdate | да | Время начисления штрафа |
| fineID | int | да | Идентификатор штрафа из базы |
| carID | int | да | Идентификатор машины, которой присвоен штраф |

### Error
Сущность, содержащая информацию об ошибке.

| Поле | Тип данных | Обязательное | Комментарий |
| --- | --- | --- | --- |
| code | String | да | Код ошибки. |
| message | String | нет | Сообщение. |

## Методы
### GET /PenaltyEvents
Возвращает список событий из БД, удовлетворяющими условиям фильтра.

### GET /PenaltyEvents/{id}
Возвращает событие по заданому идентификатору.
#### Ответ
[PenaltyEvent](#PenaltyEvent) 

#### Ошибки
| Код  | Комментарий |
| --- | --- |
| 1 | Внутренняя ошибка. |
| 3 | Сервис недоступен. |
| 4 | Событие не найдено. |

### POST /PenaltyEvents
Создает новое событие
#### Тело запроса
Дата и время начисления штрафа, идентификатор штрафа, данные машины за исключением идентификатора.
#### Ответ
[PenaltyLog](#PenaltyLog)

#### Ошибки
| Код  | Комментарий |
| --- | --- |
| 1 | Внутренняя ошибка. |
| 2 | Некорректные значения параметров. |
| 3 | Сервис недоступен. |

### PUT /PenaltyEvents/{id}
Изменяет событие по заданному идентификатору.
#### Тело запроса
Индентификатор события, дата и время начисления штрафа, идентификатор штрафа, данные машины за исключением идентификатора.
#### Ответ
[PenaltyEvent](#PenaltyEvent) (id добавленного события, госномер автомобиля, тип штрафа, начисления).

### DELETE /PenaltyEvents/{id}
Удаляет событие с заданным идентификатором.
#### Ответ
\-
#### Ошибки
| Код  | Комментарий |
| --- | --- |
| 1 | Внутренняя ошибка. |
| 3 | Сервис недоступен. |
| 4 | Событие не найдено. |

### GET /Statistics/{top}
Возвращает топ первых по популярности штрафов базы данных.
#### Ответ
[Statistics](#Statistics) 

## Список ошибок
| Код  | Комментарий | HTTP-код |
| --- | --- | --- |
| 1 | Внутренняя ошибка. | 500 Internal Server Error|
| 2 | Некорректные значения параметров. | 400 Bad Request |
| 3 | Сервис недоступен. | 503 Service Unavailable |
| 4 | Объект не найден. | 404 Not Found |
